<!DOCTYPE html>
<html >
<head>
	<meta charset="UTF-8">
	<title>Drag</title>
</head>
<body>
	<div class="draggable" style="position:absolute;background:red;width:20px;height:20px;"></div>
	<script type="text/javascript">
		var EventUtil = {

			addHandler : function(element,type,handler){
				if(element.addEventListener){
					element.addEventListener(type,handler,false);
				}else if(element.attachEvent){
					element.attachEvent(type,handler,false);
				}else{
					element["on"+type] = handler;
				}
			},

			removeHandler : function(element,type,handler){
				if(element.removeEventListener){
					element.removeEventListener(type,handler,false);
				}else if(element.detachEvent){
					element.detachEvent(type,handler,false);
				}else{
					element["on"+type] = null;
				}
			},

			getEvent : function(event){
				return event ? event : window.event;
			},

			getTarget : function(event){
				return event.target || event.srcElement;
			},

			preventDefault :function(event){
				if(event.preventDefault){
					event.preventDefault();
				}else{
					event.returnValue = false;
				}
			},

			stopPropagation : function(event){
				if(event.stopPropagation){
					event.stopPropagation();
				}else{
					event.cancelBubble = true;
				}
			},

			getRelatedTarget : function(event){
				if(event.getRelatedTarget){
					return event.getRelatedTarget;
				}else if(event.toElement){
					return event.toElement;
				}else if(event.fromElement){
					return event.fromElement;
				}else{
					return null;
				}
			},

			getButton : function(event){
				if(document.implementation.hasFeature("MouseEvents","2.0")){
					return event.button;
				}else{
					switch(event.button){
						case 0:
						case 1:
						case 3:
						case 5:
						case 7:
							return 0;
						case 2:
						case 6:
							return 2;
						case 4:
							return 1;
					}
				}
			}
		}
	</script>
	<script type="text/javascript">


		var DragDrop = function(){
			var dragging = null;
			var diffX = 0;
			var diffY = 0;

			function handleEvent(event){
				event = EventUtil.getEvent(event);
				var target = EventUtil.getTarget(event);

				switch(event.type){
					case "mousedown" :
						if(target.className.indexOf("draggable") > -1){
							dragging = target;
						}
						break;

					case "mousemove" :
						if(dragging !== null){
							event = EventUtil.getEvent(event);

							dragging.style.left = event.clientX + "px";
							dragging.style.top = event.clientY + "px";
						}
						break;
					case "mouseup" : 
						dragging = null;
						break;
				}
			}

			return {
				enable : function(){
					EventUtil.addHandler(document,"mousedown",handleEvent);
					EventUtil.addHandler(document,"mousemove",handleEvent);
					EventUtil.addHandler(document,"mouseup",handleEvent);
				},
				disable : function(){
					EventUtil.removeHandler(document,"mousedown",handleEvent);
					EventUtil.removeHandler(document,"mousemove",handleEvent);
					EventUtil.removeHandler(document,"mouseup",handleEvent);
				}
			}
		}

		DragDrop().enable()
	</script>
</body>
</html>